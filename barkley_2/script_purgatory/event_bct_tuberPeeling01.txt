/*
This is the scene that runs in the Tuber Closet
*/
if (scr_quest_get_state("tuberPeel") != 1) 
{
    with (o_tuberPeels) scr_event_interactive_deactivate();
    with (o_peeledTubers) scr_event_interactive_deactivate();
    with (o_tuberPile) scr_event_interactive_deactivate();
    exit;
}

if (argument0 == SCRIPT_START) 
{
    var event = scr_event_find_main();
    with (event) 
    {
            // Instant frame
            scr_entity_animation_set(o_cts_hoopz, "peelSit0");
            Misc("shadow", "o_cts_hoopz", 0);
            Light("add", o_cinema0, 128, 0.1, merge_color(c_black, c_white, 0.5));
            Light("set", 0.33);
            scr_event_camera_frame(o_cts_hoopz);
            scr_event_camera_move_to_point(camX, camY, 9999, 1); //test
            Wait(1);
            
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "How hard can it be?");
            scr_event_build_animation_set(o_cts_hoopz, "peelSit0");
            scr_event_build_animation_play_and_set(o_cts_hoopz, "peelSit1", "peelSit2");
            scr_event_build_wait_for_actions();
            scr_event_build_user(o_tuberPile, 10);
            scr_event_build_animation_play_and_set(o_cts_hoopz, "peelSit3", "peeling0");
            scr_event_build_wait_for_actions();
            
            event_bct_tuber_snippet(); // 1
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "Easy does it.");
            
            event_bct_tuber_snippet(); // 2
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "Heh. Two down.");
            
            event_bct_tuber_snippet(); // 3
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "Ugh...");
            
            event_bct_tuber_snippet(); // 4
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "Uggghhhhh...");
            
            event_bct_tuber_snippet(); // 5
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "So...");
            
            event_bct_tuber_snippet(); // 6
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "Hard...");
            
            event_bct_tuber_snippet(); // 7
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "...");
            
            LensFlare("build", 196 + 64, 82 - 48, 196 - 64, 82 + 48, 196 + 0, 82 - 32, 2);
            //Wait();
            
            event_bct_tuber_snippet(); // 8
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "I see it now. Their deepest secrets revealed to me.");
            
            LensFlare("build", 196 + 96, 82 - 48, 196 - 96, 82 + 48, 196 + 0, 82 - 32, 4);
            Wait(2);
            
            event_bct_tuber_snippet(); // 9
            
            // Hoopz decides to think about the Tuber                      
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "The hue of these golden rinds glisten as they part from the ecru interior of these hefty tubers. The flash of these brilliant earthly tones reminds me of..."); 
            var solitaryPeeler = scr_event_build_choice("The tubers remind me of ...", s_port_hoopz);

            // Response 1 - Candy
            with scr_event_build_add_choice(solitaryPeeler, "A scrumptious morsel of butterscotch.") {
                scr_event_build_dialogue(P_NAME, s_port_hoopz, "What else but an original delicacy of scotch and butter?  I could probably sneak a taste of one if my pockets were so lucky. But for now, back to these tubers...");
                // TODO: add something here for RM maybe? ROUNDMOUND
            }
            
            // Response 2 - Vidcons
            with scr_event_build_add_choice(solitaryPeeler, "A controller cable, proudly unfurled.") {
                scr_event_build_dialogue(P_NAME, s_port_hoopz, "These twist like coaxial cables spreading out of my favorite system. Surely the conquest of a vidcon is more constructive than peeling these stupid roots...");
                // TODO: add something here for RM maybe? ROUNDMOUND
            }
            
            // Response 3 - Vidcons
            with scr_event_build_add_choice(solitaryPeeler, "A mother.") {
                scr_event_build_dialogue(P_NAME, s_port_hoopz, "Do I even have a mother? If so, I hope I peel tubers like she would have...");
                // TODO: add something here for RM maybe? ROUNDMOUND
            }           
            
            event_bct_tuber_snippet(); // 10
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "As I sit here peeling, I wonder...");
            
            event_bct_tuber_snippet(); // 11
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "Am I peeling the tubers?");
            
            event_bct_tuber_snippet(); // 12
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "Or are they peeling me?");
            
            event_bct_tuber_snippet(); // 13
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "UGGGGHHHHH!!!");
            
            event_bct_tuber_snippet(); // 14
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "UNGH!");
            
            event_bct_tuber_snippet(); // 15
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "OURGH!!!");
            
            event_bct_tuber_snippet(); // 16
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "Hngh...");
            
            event_bct_tuber_snippet(); // 17
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "Hhhnn... Hnghhhhh...");
            
            event_bct_tuber_snippet(); // 18
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "Almost... Done...");
            
            event_bct_tuber_snippet(); // 19
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "Just... One... More... Tuber...");
            
            // Last one
            scr_event_build_animation_play_and_set(o_cts_hoopz, "peeling1", "peeling2");
            scr_event_build_wait_for_actions();
            scr_event_build_user(o_tuberPeels, 0);
            
            Wait(1);
            
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "No more! No more tubers!");
            scr_event_build_dialogue(P_NAME, s_port_hoopz, "Time to bring it back to that old guy.");
            
            // Done with tubers!
            scr_event_build_quest_state("tuberPeel", 2);
            
            // Fade out and head back to L.O.N.G.I.N.U.S. Base
            //scr_event_build_fade(true, 2);
            scr_event_build_teleport(r_bct_longinus01, 224, 240, 1, 1);
    }
    if (global.eventFound == 0) scr_event_advance(event); // Not needed on fadein
}