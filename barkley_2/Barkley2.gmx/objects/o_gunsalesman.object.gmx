<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>s_gunsalesman01</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>InteractiveActor</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Create
event_inherited();

scr_event_hook_onCommon(event_cinema);
event_user(0); // DSL

// Contains placement system for moving to new rooms
event_user(10);

// 5 guns deal
for (q = 0; q &lt; 5; q += 1) // Quality
{
    gunLoad[q] = 0;
    for (i = 0; i &lt; 5; i += 1) gunBuy[q, i] = 0;
}
//event_user(5);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="20">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Placement system
var time = ClockTime("get");
var newArea = "";
var oldArea = Quest("redfieldLastArea");

// The first area is 0 - 30 minutes in, second area is 30-60 minutes in, etc
dslArea = ds_list_create();
ds_list_add(dslArea, r_tnn_warehouseDistrict01);
ds_list_add(dslArea, r_tnn_residentialDistrict01);
ds_list_add(dslArea, r_sw1_descent01); //r_tnn_marketDistrict01);
ds_list_add(dslArea, r_sw1_descent01); //r_tnn_maingate02);
ds_list_add(dslArea, r_sw1_descent01); //r_tnn_businessDistrict01);
ds_list_add(dslArea, r_sw1_descent01); //r_tnn_bballcourt02);
ds_list_add(dslArea, r_tnn_bballcourt_transition01);
ds_list_add(dslArea, r_tnn_boardinghouse01); //3;30
ds_list_add(dslArea, r_sw1_manholeWest01);
ds_list_add(dslArea, r_sw1_manholeEast01);
ds_list_add(dslArea, r_sw1_respawn01);
ds_list_add(dslArea, r_sw1_floor2Access01);
for (i = 0; i &lt; ds_list_size(dslArea); i += 1)
{
    var are = dslArea[| i];
    if (time &lt; (i + 1) * 0.5) { newArea = are; break; }
}
ds_list_destroy(dslArea);

if (room == r_tnn_marketDistrict01) image_xscale = -1;
if (room == r_tnn_maingate02) image_xscale = -1;
if (room == r_tnn_bballcourt02) image_xscale = -1;
if (room == r_tnn_bballcourt_transition01) image_xscale = -1;
if (room == r_sw1_manholeEast01) image_xscale = -1;
if (room == r_sw1_respawn01) image_xscale = -1;
if (room == r_sw1_floor2Access01) image_xscale = -1;
if (room == r_sw1_descent01) image_xscale = -1;

//show_debug_message("Redfield - " + room_get_name(newArea) + " - OLD = " + room_get_name(oldArea));
if (room == newArea)
{
    //if (newArea == oldArea)
    //{
    //    if (Quest("redfieldTalked") == 1) scr_event_interactive_deactivate();
    //}
    if (1) //newArea != oldArea)
    {
        Quest("redfieldLastArea", newArea);
        Quest("redfieldTalked", 0);
        Quest("redfieldShop50Empty", 0);
        Quest("redfieldShop70Empty", 0);
        if (newArea == r_tnn_boardinghouse01)
        {
            with (o_door_parent)
            {
                if (name == "redfield")
                {
                    event_user(1);
                }
            }
        }
    }
}
else scr_event_interactive_deactivate();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="16">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Ran after shop is closed
qal = 0;
if (Quest("redfieldPoint") == 70) qal = 1;
if (Quest("redfieldPoint") == 90) qal = 2;
var gunAmt = 0;
for (i = 0; i &lt; 5; i += 1) gunAmt += gunBuy[qal, i];
if (gunAmt == 5) // bought all 5
{
    if (qal == 0) Quest("redfieldShop50Empty", 1);
    if (qal == 1) Quest("redfieldShop70Empty", 1);
    if (qal == 2) Quest("redfieldShop90Empty", 1);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="15">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Generate guns based on shop type
qal = 0;
if (Quest("redfieldPoint") == 70) qal = 1;
if (Quest("redfieldPoint") == 90) qal = 2;
//show_debug_message("Redfield - " + string(qal));
var luck = scr_savedata_get("player.stats.effective." + STAT_BASE_LUCK);
if (qal == 0 &amp;&amp; gunLoad[qal] == 0)
{
    gunLoad[qal] = 1;
    shpGun[qal, 0] = Drop("generate", luck, "kosmic pistol", "FUND");
    shpGun[qal, 1] = Drop("generate", luck, "kosmic rifle", "GIRF");
    shpGun[qal, 2] = Drop("generate", luck, "kosmic shotgun", "SGUN");
    shpGun[qal, 3] = Drop("generate", luck, "kosmic projectile", "GIRF");
    shpGun[qal, 4] = Drop("generate", luck, "kosmic mounted", "SGUN");
    for (i = 0; i &lt; 5; i += 1) shpPrc[qal, i] = 5 + irandom(5);
}
else if (qal == 1 &amp;&amp; gunLoad[qal] == 0)
{
    gunLoad[qal] = 1;
    shpGun[qal, 0] = Drop("generate", luck, "zauber pistol", "HELL");
    shpGun[qal, 1] = Drop("generate", luck, "zauber rifle", "NIFF");
    shpGun[qal, 2] = Drop("generate", luck, "zauber shotgun", "GOOP");
    shpGun[qal, 3] = Drop("generate", luck, "zauber projectile", "GOOP");
    shpGun[qal, 4] = Drop("generate", luck, "zauber mounted", "GOOP");
    for (i = 0; i &lt; 5; i += 1) shpPrc[qal, i] = 10 + irandom(5);
}
else if (qal == 2 &amp;&amp; gunLoad[qal] == 0)
{
    gunLoad[qal] = 1;
    shpGun[qal, 0] = Drop("generate", luck, "turald best", "ABCD");
    shpGun[qal, 1] = Drop("generate", luck, "turald best", "WXYZ");
    shpGun[qal, 2] = Drop("generate", luck, "turald best", "AAAA");
    shpGun[qal, 3] = Drop("generate", luck, "turald best", "OOOO");
    shpGun[qal, 4] = Drop("generate", luck, "turald best", "HOOP");
    for (i = 0; i &lt; 5; i += 1) shpPrc[qal, i] = 15 + irandom(5);
}

// Load prices
var shp = ds_list_find_index(global.shopName, "Redfield's Wares");
var shpCos = ds_list_find_value(global.shopCost, shp);
for (i = 0; i &lt; 5; i += 1) shpCos[| i] = shpPrc[qal, i];
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="10">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Redfield the Gun'ssalesman
//(He's Chris, we don't even try to hide it. And he's lost a lot of good partners.)
/*
redfieldState
    0 - never talked
    1 - talked, sends you to PURCHASER
redfieldPast
    0 - haven't asked about his past
    1 - have asked about his past, gotten some stupid details
How he works:
you have to have a knowledgeVariable of knowGunstiers to a certain level, when you, you 
knowGunstiers
    0 - only get 50 point gun's
    1 - get 70 point gun's
stahlGuns
    1 - learned you can get better stuff from redfield from stahl
    2 - told redfield that stahl sent you, have access to better stuff
*/
script = "
QUEST | redfieldTalked = 1
IF body == governor | GOTO | GOVERNOR
IF redfieldState == 1 | GOTO | REDFIELD01
IF redfieldState == 0 | GOTO | REDFIELD00

GOVERNOR
DIALOG | Redfield | Evening, sir. Nothing suspicious going on here.

REDFIELD01
DIALOG | Redfield | I've got gun's for sale. Top quality hardware. Some of these would have loved to brast in my days as a /'professional./' I can let you take a look. But remember, you only get one peek. Someone in my line of business needs to keep moving.
GOTO   | PURCHASER

REDFIELD00
QUEST  | redfieldState = 1
DIALOG | Redfield | I'm Redfield. 
WAIT   | 1
DIALOG | Redfield | Glad you found me. I sell gun's... at least, mostly gun's.
DIALOG | P_NAME   | Hi, I'm P_NAME_S-
DIALOG | Redfield | Let me stop you there, kid. We aren't friends... I don't want to get to know you. I just want to know how many neuroshekels you have in that brainpan of yours and how much you are willing to part with.
DIALOG | P_NAME   | Oh... sorry...
WAIT   | 0.5
DIALOG | Redfield | Look, sorry kid. It's just_ it's best if we keep this strictly business. Best not get too close. Especially to me. Now whatcha buyin'?
GOTO   | PURCHASER

PURCHASER
CHOICE | Whatcha buyin'?
IF redfieldShop90Empty == 0 | IF redfieldUpgrade &gt;= 2 | REPLY | SHOP90 | Show me the top shelf wares!
IF redfieldShop70Empty == 0 | IF redfieldUpgrade &gt;= 1 | REPLY | SHOP70 | Show me the good stuff.
IF redfieldShop50Empty == 0 | IF redfieldUpgrade &gt;= 1 | REPLY | SHOP50CHEAP | Show me the cheaper gun's.
IF redfieldShop50Empty == 0 | IF redfieldUpgrade == 0 | REPLY | SHOP50FIRST | Show me your gun's.
IF stahlGuns == 1 | REPLY | UPGRADE_STAHL | Stahl said you could hook me up
IF redfieldTuraldUpgrade == 0 | IF knowGunstiers == 1 | IF redfieldShoppedNOW == 1 | REPLY | UPGRADE_TURALD | I know my Gun'stiers. Those gun's suck.
IF redfieldPast == 0 | REPLY | YOURPAST | You seem to have a dark past.
IF redfieldMap == 0 | REPLY | MAP_INQUIRE | Anything else for sale?
IF redfieldMap == 1 | REPLY | MAP_PURCHASE | About buying that Sewer Map...
REPLY | NARYYEMIND | Gotta go...

UPGRADE_STAHL
QUEST  | stahlGuns = 2
DIALOG | P_NAME | Stahl said you could hook me up with better brastware's.
DIALOG | Redfield | Oh, so you've met her? She's not the type to kiss and tell. You must be important enough.
WAIT   | 0.5
GOTO   | UPGRADE_GENERAL

UPGRADE_TURALD
QUEST  | redfieldTuraldUpgrade = 1
DIALOG | P_NAME = s_port_hoopzAngry | I thought you said you had the good stuff? I know my Gun'stiers, and these gun's can't hack it.
DIALOG | Redfield | Heh heh heh... you got me kid. Not bad... I thought I could pass some of my lower grade junk on to ya. But it looks like you actually have an eye for gun's...
WAIT   | 0.5
GOTO   | UPGRADE_GENERAL

UPGRADE_GENERAL
IF redfieldUpgrade == 0 | DIALOG | Redfield | Alright. I'm gonna show you the primo material. Have a look...
IF redfieldUpgrade == 1 | DIALOG | Redfield | Alright. I'll show you the gun's `w1`THEY`w0` don't want you to know about. Have a look...
QUEST  | redfieldUpgrade += 1
QUEST  | redfieldShoppedNOW = 1
IF redfieldUpgrade == 1 | GOTO   | SHOP70
IF redfieldUpgrade == 2 | GOTO   | SHOP90

MAP_INQUIRE
DIALOG | P_NAME   | Do you have anything else for sale?
DIALOG | Redfield | As a matter of fact, I recently found a map on a deceased dwarf. It maps out some of the Tir na Nog sewers. 
QUEST  | redfieldMap = 1
GOTO   | MAP_PURCHASE

MAP_PURCHASE
DIALOG | P_NAME | A map of the Tir na Nog sewers...
Breakout | add | money | -@money_gunsalesmanMap@ | 0
DIALOG | Redfield | That's right. I'd let it go for @money_gunsalesmanMap@ neuroshekels. Interested?
CHOICE | Buy the Sewers Map? (Â£@money_gunsalesmanMap@)
REPLY  | MAP_YES | I'll take it.
REPLY  | MAP_NO  | I don't want it.

MAP_YES
IF money &gt;= @money_gunsalesmanMap@ | GOTO | MAP_AFFORD
GOTO | MAP_UNAFFORD

MAP_AFFORD
QUEST  | money -= @money_gunsalesmanMap@
DIALOG | P_NAME | Color me interested. I'll take it.
Breakout | clear
Map    | gain | Sewers Floor 1
NOTIFY | You got the Sewers Floor 1 Map.
QUEST  | redfieldMap = 2
DIALOG | Redfield | Thanks. Is there anything else you want?
GOTO   | PURCHASER

MAP_UNAFFORD
DIALOG | P_NAME | I'll take it! Oh, crud... I don't have enough.
Breakout | clear
DIALOG | Redfield | Not a problem. Is there anything else you want?
GOTO   | PURCHASER

MAP_NO
Breakout | clear
DIALOG | P_NAME | I don't want it. I'll navigate the sewers using my orienteering skills.
DIALOG | Redfield | Suit yourself. Is there anything else you want?
GOTO   | PURCHASER

YOURPAST
DIALOG | P_NAME | You seem to have a dark past. Maybe I could help illuminate it?
DIALOG | Redfield | You are playing with fire, kid._ I'm dangerous... and the people that I care about have a funny way of turning up dead.
DIALOG | P_NAME = s_port_hoopzSad | Oh... I'm sorry.
DIALOG | Redfield | I was too._._._ sorry for too long. I knew I needed to honor the lives of my fallen comrades with something. So I got back to work.
DIALOG | P_NAME | Selling gun's?
DIALOG | Redfield | That's right. I plan to make enough money running brastware to dedicate a park or memorial to all those that I've lost. I hear you can get some nice plots of land in the Swamps.
DIALOG | P_NAME | That's very thoughful of you.
DIALOG | Redfield | Thank you, now, enough about me. Let's show you my stock...
QUEST  | redfieldPast = 1
GOTO   | PURCHASER

SHOP50
IF gunsbag == 20 | GOTO | GUNSBAG_FULL
QUEST | redfieldPoint = 50
EVENT | o_gunsalesman | 5
SHOP  | open | Redfield's Wares
EVENT | o_gunsalesman | 6
IF shop == bought_toomuch | DIALOG | P_NAME | I filled up my gun'sbag, I have to stop shopping...
GOTO  | PURCHASER

SHOP70
IF gunsbag == 20 | GOTO | GUNSBAG_FULL
QUEST | redfieldPoint = 70
EVENT | o_gunsalesman | 5
SHOP  | open | Redfield's Wares
EVENT | o_gunsalesman | 6
IF shop == bought_toomuch | DIALOG | P_NAME | I filled up my gun'sbag, I have to stop shopping...
GOTO  | PURCHASER

SHOP90
IF gunsbag == 20 | GOTO | GUNSBAG_FULL
QUEST | redfieldPoint = 90
EVENT | o_gunsalesman | 5
SHOP  | open | Redfield's Wares
EVENT | o_gunsalesman | 6
IF shop == bought_toomuch | DIALOG | P_NAME | I filled up my gun'sbag, I have to stop shopping...
GOTO  | PURCHASER

SHOP120
IF gunsbag == 20 | GOTO | GUNSBAG_FULL
QUEST | redfieldPoint = 120
EVENT | o_gunsalesman | 5
SHOP  | open | Redfield's Wares
EVENT | o_gunsalesman | 6
IF shop == bought_toomuch | DIALOG | P_NAME | I filled up my gun'sbag, I have to stop shopping...
GOTO  | PURCHASER

GUNSBAG_FULL
DIALOG | P_NAME | (I can't shop, my gun'sbag is full...)
GOTO   | PURCHASER

SHOP50CHEAP
DIALOG | P_NAME | Let me see the cheaper gun's.
DIALOG | Redfield | Alright, here they are.
QUEST  | redfieldShoppedNOW = 1
GOTO   | SHOP50

SHOP50FIRST
DIALOG | P_NAME | I'll take a look at your gun's.
DIALOG | Redfield | Alright, but let's be quick about it. Blue eyes abound.
QUEST  | redfieldShoppedNOW = 1
GOTO   | SHOP50

NARYYEMIND
IF area == sw1 | GOTO | INTHESEWERS
IF area == sw2 | GOTO | INTHESEWERS
IF redfieldEnd == 1 | GOTO | NARYYEMINDSECOND
GOTO | NARYYEMINDFIRST

NARYYEMINDSECOND
DIALOG | P_NAME | I'll have to talk to you later.
DIALOG | Redfield | Sounds good kid, but remember. I don't stick around for long.

NARYYEMINDFIRST
DIALOG | P_NAME | Sorry, gotta go.
DIALOG | Redfield | Alright, well I gotta move. If you see me again, I'll probably have a new inventory. Weapons move fast these days...
QUEST  | redfieldEnd == 1
GOTO   | END

INTHESEWERS
DIALOG | Redfield | Shooting wildly ain't gonna get you anywhere. Stick to the shadows.
GOTO   | END

END
QUEST | redfieldShoppedNOW = 0
EXIT
"
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints>
    <point>12,28</point>
    <point>21,21</point>
  </PhysicsShapePoints>
</object>
