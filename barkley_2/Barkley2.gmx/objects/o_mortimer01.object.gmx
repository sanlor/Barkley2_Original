<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>s_mortimer01</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>InteractiveActor</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited()
shadow_radius = false;
timer_delay = 5;
audioemit = audio_emitter_create();

scr_event_hook_onInteract(event_cinema);

//Meeting and Robbing
event_user(0);
//Candy Shop
event_user(1);

scr_entity_animation_define("default", s_mortimer01, 0, 33, ANIMATION_DEFAULT_SPEED * 0.75);
scr_entity_animation_define("scared1", s_mortimer_scared, 0, 1, 0);
scr_entity_animation_define("scared2", s_mortimer_scared, 1, 1, 0);

// Disable during curfew //
if (scr_time_db("tnnCurfew") == "during") then scr_event_interactive_deactivate();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>// Inherit //
event_inherited();

// Pause //
if paused() exit;

// Sound //
if _active = true and sprite_index = s_mortimer01 then
    {
    if timer_delay &gt; 0 then
        {
        timer_delay -= dt();
        if timer_delay &lt;= 0 then 
            {
            audio_emitter_falloff(audioemit,80,150,1);
            audio_emitter_gain(audioemit,1 * global.sfx_gain_master);
            audio_emitter_position(audioemit,x,y,0);
            
            }
        }
    else
        {
        var guplur = _last_frame //image_index;
        if round(guplur) = 0 and !audio_is_playing_ext("sn_mortimer_drumroll") then audio_play_sound_on_ext(audioemit,"sn_mortimer_drumroll",false,80);  
        if round(guplur) = 17 and !audio_is_playing_ext("sn_mortimer_drumroll") then audio_play_sound_on_ext(audioemit,"sn_mortimer_drumroll",false,80);
        }
    }    

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="20">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Update count of vidcons for sale
if (Shop("stocks", "Mortimer's Candy Shop") == 0) Quest("shopEmpty", 1);
else Quest("shopEmpty", 0);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="19">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Checks if Hoopz has Mallows
Quest("chocomallowsRecipeHas", Candy("recipe has", "Choco-mallows"));
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="11">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///TODO: Add Candy Shop Here
/*
    Needs a list of recipes available for purchase
    Choco-mallows need to be VERY expensive
*/
script += "
CANDYSHOP
QUEST | mortimerShopped = 1
EVENT | o_mortimer01 | 10 // Check if the shop is empty
IF shopEmpty == 1 | GOTO | SHOP_EMPTY
SHOP | open | Mortimer's Candy Shop
IF mortimerState == 3 | DIALOG | Mortimer | You got what you came for, just go...
IF mortimerState != 3 | DIALOG | Mortimer | Thank you, come again.
EXIT |

SHOP_EMPTY
DIALOG | Mortimer | Oh, I'm all out of recipes... Is there anything else I can do for you?
GOTO   | CANDY_CHOICE
"
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="10">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Event for Mortimer, normally goes to Candy Shop
/*
NOTES: send to EVENT | o_mortimer01 | 2 when wanting to buy candy schemes

variables
    mortimerState
        0 - haven't met Mortimer
        1 - talked to Mortimer
        2 - cooldown has expired and you can now buy candy from Mortimer
    mortimerShopped
        0 - haven't purchased Candy Schemes
        1 - have looked at Candy from Mortimer (seen how expensive Choco-mallows are)
    mortimerRobbed
        0 - haven't robbed Mortimer
        1 - have robbed Mortimer
        2 - repeating dialog until the robbery cooldown has expired
    mortimerJobOpen
        0 - haven't asked about the job for Eric
        1 - have asked, no longer available
*/

script = "
IF govCandy == 2    | GOTO | GIVE_CANDY
IF body == governor | GOTO | GOVERNOR
IF comServ == 4     | GOTO | ROBBERY
IF mortimerState == 3 | GOTO | MORTIMER_03
IF mortimerRobbed == 2 | GOTO | ROBBEDREPEAT
IF mortimerRobbed == 1 | GOTO | ROBBED
IF mortimerState == 1 | GOTO | MORTIMER_01
IF mortimerState == 0 | GOTO | MORTIMER_00

GIVE_CANDY
DIALOG | Mortimer | That Governor... He's a real piece of work! I don't even have any candy to give. What am I gonna do?

GOVERNOR
IF mortimerGov == 1 | GOTO | GOVERNOR1
DIALOG | Mortimer | Y-you must be the new g-g-governor! P-pleasure to meet you, sir! // P-p-please take this black licorice recipe... It's on me, sir!
//NOTIFY | Got Black Licorice Recipe!
DIALOG | Governor Elagabalus | Thank you! // But you didn't need to do that...
QUEST  | mortimerGov = 1
GOTO | END

GOVERNOR1
DIALOG | Mortimer = s_port_mortimer_rob | M-m-mr. Governor! Please stop by Mortimer's Candy Shop anytime! W-w-we love to serve Duergars!
GOTO | END

" +
//ROBBERY SEQUENCE
"
ROBBERY
DIALOG | Mortimer | Welcome to Mortimer's Candy Shop! What can I get for you, youngster?
DIALOG | P_NAME   | Hi! I'm here to pick up some money for Mr. Cornrow and Mr. Juicebox. Mr. Cornrow said Mr. Juicebox gave you some money and got the wrong change in return.
DIALOG | Mortimer | Ha, kid, you're too nice to get mixed up with the likes of those two miscreants.
DIALOG | P_NAME = s_port_hoopzAngry | Isn't miscreant a kinda harsh word? Mr. Cornrow told me to show you his gun so you'd know I'm here for him.
" +
//TODO: add either a "aiming gun sprite", (which could be useful) or even further, a "fake gun draw" that essentially looks like this GUNDRAW | bando 1-5 | (direction of object to draw at)
"
SET    | o_mortimer01 | scared1
BREAKOUT | add | money
DIALOG | Mortimer = s_port_mortimer_rob  | Wh-whoa! Let's s-slow down here! Uhhh, y-y-yeah! What the hell is Cornrow trying to pull? Tell him I wasn't moving in on his shipment, I was just trying to get my piece of the pie!
DIALOG | P_NAME | Oh, I'm sure this isn't that big of a deal... Mr. Cornrow is just trying to help Juicebox with his numbers.
EVENT  | o_mortimer01 | 9
IF chocomallowsRecipeHas == 0 | GOTO | ROB_STANDARD
GOTO   | ROB_SPECIAL

ROB_STANDARD
DIALOG | Mortimer = s_port_mortimer_rob  | Look, man. Take the recipe, and tell Cornrow I didn't mean anything by it.
DIALOG | P_NAME | What recipe?
WAIT   | 0.3
NOTIFY | Mortimer coughed up the Choco-mallows Recipe!
Candy  | recipe add | Choco-mallows
DIALOG | P_NAME = s_port_hoopzHappy | Wow, this looks like a great recipe! Cornrow will love it!
GOTO   | ROB_CONTINUE

ROB_SPECIAL
DIALOG | Mortimer = s_port_mortimer_rob  | Look, man. I don't know what you're playing at, you already have the Choco-mallows recipe!
DIALOG | P_NAME | (Hmmm, I wonder why he's talking about the recipe I bought from him...)
GOTO   | ROB_CONTINUE

ROB_CONTINUE
DIALOG | Mortimer = s_port_mortimer_rob  | J-just, put the gun down and let me run my shop in peace...
DIALOG | P_NAME | Oh... what about Juicebox's change?
DIALOG | Mortimer = s_port_mortimer_rob  | Clispaeth Christ... where are the Duergars when you need them?!
WAIT | 0.5
QUEST  | money += @money_mortimerRobbery@
DIALOG | P_NAME | Thanks, Morty! I'll see you later!
BREAKOUT | clear
SET    | o_mortimer01 | scared2
DIALOG | Mortimer = s_port_mortimer_sad | H-holy Clispaeth...
QUEST | mortimerRobbed = 1
ClockTime | event | mortimerState | 3 | 60
QUEST  | comServ = 5
GOTO | END

ROBBED
SET    | o_mortimer01 | scared2
DIALOG | Mortimer = s_port_mortimer_sad | You again?! J-just leave me alone!
DIALOG | P_NAME | I was thinking I could get some candy from you?
DIALOG | Mortimer = s_port_mortimer_sad | Shop's closed, give me some time to process what just happened!
GOTO | END

ROBBEDREPEAT
IF time &gt;= timerReopen | GOTO | MORTIMER_02
DIALOG | Mortimer = s_port_mortimer_sad | Shop's closed.
GOTO | END

MORTIMER_03
QUEST | mortimerState = 3
SET | o_mortimer01 | scared2
DIALOG | Mortimer = s_port_mortimer_sad | I don't want any trouble, just buy what you need and get out of here!
GOTO | CANDYSHOP

MORTIMER_01
DIALOG | Mortimer | Whattday know, P_NAME_S?
GOTO | CANDY_CHOICE

MORTIMER_00
DIALOG | Mortimer | Welcome to Mortimer's Candy Shop, youngster. What can I get for you?
DIALOG | P_NAME = s_port_hoopzHappy | This is a candy store? Then I want CANDY, of course! Candy, candy, candy!
DIALOG | Mortimer | Well... I just sell recipes here actually. During the transition to the new governor, we can't sell candy, go to the bank, or get out of Tir na nOg.
DIALOG | P_NAME = s_port_hoopzAngry | A candy store with no candy? What kind of scam is this?
DIALOG | Mortimer | Well there's no law against selling recipes. In case you come across another confectioner out in the Wastelands or, I suppose a 3D Printer would work too...
QUEST | mortimerState = 1
GOTO | CANDY_CHOICE

CANDY_CHOICE
CHOICE | Whaddya want?
IF knowCandyPrint == 0 | REPLY | PRINTEDCANDY | 3D Printing Candy?
REPLY | SHOP_OPEN | Let me see your recipes.
IF mortimerRobbed == 0 | IF mortimerShopped &gt;= 1 | REPLY | CHOCOMALLOWS | Why are Choco-mallows so expensive?
IF ericQuest == 2 | IF mortimerJobOpen == 0 | REPLY | JOBOPENING | Got any job openings?
REPLY | NEVERMIND | Nary ye mind.

PRINTEDCANDY
DIALOG | P_NAME | What did you mean by printing candy?
DIALOG | Mortimer | I meant what I said, candy printing from a 3D printer.
DIALOG | P_NAME = s_port_hoopzSurprise | Wow! You can do that?!
DIALOG | Mortimer | Of course you can! What year do you think we're livin' in, 2053?! You can print out anything you'd like, gun's, candy, organs... vidcons even if you aren't a purist.
DIALOG | P_NAME | Wow...
DIALOG | Mortimer | Too bad the Governor also outlawed 3D Printers... but maybe outside Tir na nOg you can find one. So what do you say, want some recipes?
QUEST | knowCandyPrint = 1
GOTO | CANDY_CHOICE

SHOP_OPEN
DIALOG | P_NAME | Sure let me take a look at your recipes.
GOTO | CANDYSHOP

CHOCOMALLOWS
DIALOG | P_NAME | Why are those Choco-mallows so expensive?
DIALOG | Mortimer | Supply and demand, kid. You see, there used to be a steady stream of Choco-mallows coming into Tir na nOg, and prices were low. Problem was, it was all black market mallows, some say shipped in Underground from Al Akihabara. Recently the Duergars started cracking down illegal strweets - that's short for /'street sweets./'
DIALOG | P_NAME | Strweets? I was even listening to you and I have no idea how to prounounce that...
DIALOG | Mortimer | Well regardless, the crackdown hit and the strweets dried up, and with them Choco-mallows became rarer than hen's nipples. Hence the price hike.
DIALOG | P_NAME | Doesn't seem fair to all the mallow lovers out there without the means.
DIALOG | Mortimer | Laissez-faire, kid. If you really want it, you'll buy it.
GOTO | CANDY_CHOICE

JOBOPENING
DIALOG | P_NAME | I was just wondering if you had any jobs available.
DIALOG | Mortimer | You gotta be joking, I can barely limp by now while the Candy Ban is active and the Chocomallow supply dried up. You'd be better off selling pet food than candy.
DIALOG | P_NAME | Ahh... good to know.
GOTO | CANDY_CHOICE

NEVERMIND
DIALOG | P_NAME | Nary ye mind, I'll check out your stock more later!
GOTO | END

END
EXIT |
"

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>audio_emitter_free(audioemit);
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints>
    <point>17,34</point>
    <point>18,18</point>
  </PhysicsShapePoints>
</object>
